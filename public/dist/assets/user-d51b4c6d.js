import{j as e,g as W,h as j,$ as ie,T as I,P as a,r as i,a0 as oe,a1 as R,a2 as V,a3 as ce,Y as O,I as C,D as de,n as ue,o as he,L as F,b as f,p as me,B as P,f as xe,i as pe,a4 as ge,a5 as je,a6 as M,C as fe,S as be,a as $,c as Ce,d as ye,e as Se,k as ve,m as Te,N as we,a7 as Pe,q as _,W as Ie}from"./index-362d11ce.js";import{I as Ae}from"./InputAdornment-9e08267f.js";function K({query:s}){return e.jsx(W,{children:e.jsx(j,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ie,{sx:{textAlign:"center"},children:[e.jsx(I,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(I,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',s,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}K.propTypes={query:a.string};function z({selected:s,name:r,client_code:n,email:o,phone:c,address:u,handleClick:b,suctomerId:y}){const[l,T]=i.useState(null),[h,A]=i.useState(!1),[m,E]=i.useState({}),N=oe(),w=()=>{T(null)},q=()=>{E({name:r,client_code:n,email:o,phone:c,address:u}),A(!0)},k=()=>{N(`/credit/?suctomerId=${y}`)},x=()=>{A(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(W,{hover:!0,tabIndex:-1,role:"checkbox",selected:s,children:[e.jsx(j,{children:n}),e.jsx(j,{children:r}),e.jsx(j,{children:c}),e.jsx(j,{children:o}),e.jsx(j,{children:u}),e.jsx(j,{children:e.jsx(R,{onClick:q,children:e.jsx(V,{})})}),e.jsx(j,{children:e.jsx(R,{onClick:k,children:e.jsx(V,{})})})]}),e.jsxs(ce,{open:!!l,anchorEl:l,onClose:w,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(O,{onClick:w,children:[e.jsx(C,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(O,{onClick:w,sx:{color:"error.main"},children:[e.jsx(C,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]}),e.jsxs(de,{open:h,onClose:x,maxWidth:"md",fullWidth:!0,children:[e.jsx(ue,{children:"Customer Details"}),e.jsx(he,{children:m&&e.jsxs(F,{sx:{display:"flex",flexDirection:"column",gap:2,p:2},children:[e.jsx(f,{label:"Name",value:m.name||"",fullWidth:!0,InputProps:{readOnly:!0}}),e.jsx(f,{label:"Client Code",value:m.client_code||"",fullWidth:!0,InputProps:{readOnly:!0}}),e.jsx(f,{label:"Phone",value:m.phone||"",fullWidth:!0,InputProps:{readOnly:!0}}),e.jsx(f,{label:"Email",value:m.email||"",fullWidth:!0,InputProps:{readOnly:!0}}),e.jsx(f,{label:"Address",value:m.address||"",fullWidth:!0,InputProps:{readOnly:!0}})]})}),e.jsxs(me,{sx:{justifyContent:"center"},children:[e.jsx(P,{onClick:()=>N(`/credit/?suctomerId=${y}`),color:"primary",children:"View Customer Credits"}),e.jsx(P,{onClick:x,color:"primary",children:"Close"})]})]})]})}z.propTypes={name:a.string.isRequired,client_code:a.string.isRequired,email:a.string.isRequired,address:a.string.isRequired,phone:a.string.isRequired,selected:a.bool.isRequired,handleClick:a.func.isRequired,suctomerId:a.string.isRequired};const Ee={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function B(s,r,n){return s[n]===null?1:r[n]===null||r[n]<s[n]?-1:r[n]>s[n]?1:0}function Ne(s,r){return s==="desc"?(n,o)=>B(n,o,r):(n,o)=>-B(n,o,r)}function ke({inputData:s,comparator:r,filterName:n}){const o=s.map((c,u)=>[c,u]);return o.sort((c,u)=>{const b=r(c[0],u[0]);return b!==0?b:c[1]-u[1]}),s=o.map(c=>c[0]),n&&(s=s.filter(c=>c.name.toLowerCase().indexOf(n.toLowerCase())!==-1)),s}function H({order:s,orderBy:r,rowCount:n,headLabel:o,numSelected:c,onRequestSort:u,onSelectAllClick:b}){const y=l=>T=>{u(T,l)};return e.jsx(xe,{children:e.jsx(W,{children:o.map(l=>e.jsx(j,{align:l.align||"left",sortDirection:r===l.id?s:!1,sx:{width:l.width,minWidth:l.minWidth},children:e.jsxs(pe,{hideSortIcon:!0,active:r===l.id,direction:r===l.id?s:"asc",onClick:y(l.id),children:[l.label,r===l.id?e.jsx(F,{sx:{...Ee},children:s==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}H.propTypes={order:a.oneOf(["asc","desc"]),orderBy:a.string,rowCount:a.number,headLabel:a.array,numSelected:a.number,onRequestSort:a.func,onSelectAllClick:a.func};function Y({emptyRows:s,height:r}){return s?e.jsx(W,{sx:{...r&&{height:r*s}},children:e.jsx(j,{colSpan:9})}):null}Y.propTypes={emptyRows:a.number,height:a.number};function G({numSelected:s,filterName:r,onFilterName:n}){return e.jsxs(ge,{sx:{height:96,display:"flex",justifyContent:"space-between",p:o=>o.spacing(0,1,0,3),...s>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[s>0?e.jsxs(I,{component:"div",variant:"subtitle1",children:[s," selected"]}):e.jsx(je,{value:r,onChange:n,placeholder:"Search user...",startAdornment:e.jsx(Ae,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),s>0?e.jsx(M,{title:"Delete",children:e.jsx(R,{children:e.jsx(C,{icon:"eva:trash-2-fill"})})}):e.jsx(M,{title:"Filter list",children:e.jsx(R,{children:e.jsx(C,{icon:"ic:round-filter-list"})})})]})}G.propTypes={numSelected:a.number,filterName:a.string,onFilterName:a.func};function Re(){const[s,r]=i.useState(0),[n,o]=i.useState("asc"),[c,u]=i.useState([]),[b,y]=i.useState("name"),[l,T]=i.useState(""),[h,A]=i.useState(5),[m,E]=i.useState([]),[N,w]=i.useState(0),[q,k]=i.useState(!1),[x,J]=i.useState({firstName:"",surname:"",phone:"",email:"",address:"",userType:"RECEIVABLE"}),[p,L]=i.useState({});i.useEffect(()=>{(async()=>{try{const d=localStorage.getItem("authKey"),g=await _.get("http://65.1.233.188:9000/api/v1/admin/user/get-all-customer",{headers:{authKey:`${d}`}}),{data:v}=g.data;E(v),w(g.data.totalLength)}catch(d){console.error("There was an error fetching the users!",d)}})()},[s,h]);const Q=()=>{k(!0)},U=()=>{k(!1),L({})},X=(t,d)=>{d!==""&&(o(b===d&&n==="asc"?"desc":"asc"),y(d))},Z=t=>{if(t.target.checked){const d=m.map(g=>g.firstName);u(d);return}u([])},ee=(t,d)=>{r(d)},se=t=>{r(0),A(parseInt(t.target.value,10))},te=t=>{r(0),T(t.target.value)},D=ke({inputData:m,comparator:Ne(n,b),filterName:l}),re=!D.length&&!!l,ne=()=>{const t={};return x.firstName||(t.firstName="First name is required"),x.surname||(t.surname="Surname is required"),(!x.phone||!/^\d{10}$/.test(x.phone))&&(t.phone="Valid phone number (10 digits) is required"),x.address||(t.address="Address is required"),L(t),Object.keys(t).length===0},S=t=>{const{name:d,value:g}=t.target;J(v=>({...v,[d]:g}))},ae=async t=>{if(t.preventDefault(),!ne())return;const d=localStorage.getItem("authKey");try{const v=(await _.post("http://65.1.233.188:9000/api/v1/admin/user/create-customer",x,{headers:{authKey:`${d}`}})).data.data;console.log({newUser:v}),E(le=>[...le,v]),U()}catch(g){console.error("There was an error creating the user!",g),alert("Error creating user")}};return i.useState(null),e.jsxs(fe,{children:[e.jsxs(be,{direction:"row",alignItems:"center",justifyContent:"space-between",mt:5,mb:5,children:[e.jsx(I,{variant:"h4",children:"Customer"}),e.jsxs($,{children:[e.jsx(P,{variant:"contained",color:"inherit",startIcon:e.jsx(C,{icon:"eva:plus-fill"}),onClick:Q,children:"Add New Customer"}),e.jsx(P,{variant:"contained",color:"primary",sx:{marginLeft:5},startIcon:e.jsx(C,{icon:"eva:download-fill"}),onClick:()=>alert("Coming Soon !"),children:"Download Data"})]})]}),e.jsxs($,{children:[e.jsx(G,{numSelected:c.length,filterName:l,onFilterName:te}),e.jsx(Ce,{children:e.jsx(ye,{sx:{overflow:"unset",p:2},children:e.jsxs(Se,{sx:{minWidth:800},children:[e.jsx(H,{order:n,orderBy:b,rowCount:m.length,numSelected:c.length,onRequestSort:X,onSelectAllClick:Z,headLabel:[{id:"client_code",label:"Client Code"},{id:"name",label:"Name",align:"center"},{id:"phone",label:"Phone"},{id:"email",label:"Email"},{id:"address",label:"Address"},{id:"View Details",label:"View Details"},{id:"View Credit",label:"View Credit"}]}),e.jsxs(ve,{children:[D.slice(s*h,s*h+h).map(t=>e.jsx(z,{client_code:t.client_code,name:`${t.firstName} ${t.surname}`,phone:t.phone,email:t.email,address:t.address,suctomerId:t._id},t._id)),e.jsx(Y,{height:h-D.slice(s*h,s*h+h).length}),re&&e.jsx(K,{colSpan:6})]})]})})}),e.jsx(Te,{rowsPerPageOptions:[5,10,25],component:"div",count:N,rowsPerPage:h,page:s,onPageChange:ee,onRowsPerPageChange:se})]}),e.jsx(we,{open:q,onClose:U,children:e.jsxs(F,{sx:{p:3,width:400,mx:"auto",mt:10,mb:10,bgcolor:"background.paper"},children:[e.jsx(I,{variant:"h6",gutterBottom:!0,children:"Add New Customer"}),e.jsxs("form",{onSubmit:ae,children:[e.jsx(f,{label:"First Name",name:"firstName",fullWidth:!0,margin:"normal",onChange:S,error:!!p.firstName,helperText:p.firstName}),e.jsx(f,{label:"Surname",name:"surname",fullWidth:!0,margin:"normal",onChange:S,error:!!p.surname,helperText:p.surname}),e.jsx(f,{label:"Phone",name:"phone",fullWidth:!0,margin:"normal",onChange:S,error:!!p.phone,helperText:p.phone}),e.jsx(f,{label:"Email",name:"email",fullWidth:!0,margin:"normal",onChange:S,error:!!p.email,helperText:p.email}),e.jsx(f,{label:"Address",name:"address",fullWidth:!0,margin:"normal",onChange:S,error:!!p.address,helperText:p.address}),e.jsxs(Pe,{name:"userType",value:x.userType,onChange:S,fullWidth:!0,margin:"normal",children:[e.jsx(O,{value:"RECEIVABLE",children:"RECEIVABLE"}),e.jsx(O,{value:"PAYABLE",children:"PAYABLE"})]}),e.jsx(F,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(P,{type:"submit",variant:"contained",color:"primary",children:"Add Customer"})})]})]})})]})}function We(){return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{children:e.jsx("title",{children:" User  "})}),e.jsx(Re,{})]})}export{We as default};
