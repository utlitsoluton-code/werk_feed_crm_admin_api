import{a1 as J,N as Q,r as s,j as e,C as X,S as ee,T as I,a as F,B as f,I as A,a2 as ae,c as te,d as se,e as ne,f as re,g as p,h as i,k as le,a3 as ie,a4 as oe,m as de,O as ce,M as B,b as o,a5 as he,Z as L,q as C,a6 as D,W as ue}from"./index-98bf78b2.js";function me(){const b=J(),y=Q(),[h,x]=s.useState(0);s.useState("asc");const[U,xe]=s.useState([]);s.useState("name");const[g,W]=s.useState(""),[c,$]=s.useState(5),[R,S]=s.useState([]),[_,k]=s.useState(0),[M,T]=s.useState(!1),[u,v]=s.useState(),[n,q]=s.useState({firstName:"",surname:"",client_code:u,phone:"",email:"",address:"",userType:"RECEIVABLE"});console.log({formData:n,clientId:u});const[l,N]=s.useState({}),m=localStorage.getItem("authKey");s.useEffect(()=>{(async()=>{try{const t=await C.get("http://65.1.233.188:9000/api/v1/admin/user/get-all-customer",{headers:{authKey:`${m}`}}),{data:r}=t.data;S(r),k(t.data.totalLength)}catch(t){console.error("There was an error fetching the users!",t)}})()},[m,h,c]);const w=async()=>{await C.get("http://65.1.233.188:9000/api/v1/admin/user/generate-client-id",{headers:{authKey:`${m}`}}).then(a=>{var t,r;console.log({response:(t=a==null?void 0:a.data)==null?void 0:t.client_code}),v((r=a==null?void 0:a.data)==null?void 0:r.client_code)})},K=()=>{T(!0),w()},P=()=>{T(!1),N({})},O=(a,t)=>{x(t)},V=a=>{x(0),$(parseInt(a.target.value,10))},Y=a=>{x(0),W(a.target.value)},E=R.filter(a=>{const t=`${a.firstName} ${a.surname}`.toLowerCase(),r=g.toLowerCase();return t.includes(r)||a.phone.toLowerCase().includes(r)||a.client_code.toLowerCase().includes(r)}),G=!E.length&&!!g,H=()=>{const a={};return n.firstName||(a.firstName="First name is required"),n.surname||(a.surname="Surname is required"),(!n.phone||!/^\d{10}$/.test(n.phone))&&(a.phone="Valid phone number (10 digits) is required"),n.address||(a.address="Address is required"),N(a),Object.keys(a).length===0},d=a=>{const{name:t,value:r}=a.target;q(j=>({...j,[t]:r}))},Z=async a=>{if(a.preventDefault(),!!H())try{await C.post("http://65.1.233.188:9000/api/v1/admin/user/create-customer",{firstName:n.firstName,surname:n.surname,phone:n.phone,email:n.email,address:n.address,userType:n.userType,client_code:u},{headers:{authKey:`${m}`}}).then(t=>{const r=t.data.data;y(D(t.data.data)),v(),S(j=>[...j,r]),P(),b("/user-details")})}catch(t){console.error("There was an error creating the user!",t),alert("Error creating user")}};s.useState(null);const z=a=>{y(D(a)),b("/user-details")};return e.jsxs(X,{children:[e.jsxs(ee,{direction:"row",alignItems:"center",justifyContent:"space-between",mt:5,mb:5,children:[e.jsx(I,{variant:"h4",children:"Customer"}),e.jsxs(F,{children:[e.jsx(f,{variant:"contained",color:"inherit",startIcon:e.jsx(A,{icon:"eva:plus-fill"}),onClick:K,children:"Add New Customer"}),e.jsx(f,{variant:"contained",color:"primary",sx:{marginLeft:5},startIcon:e.jsx(A,{icon:"eva:download-fill"}),onClick:()=>alert("Coming Soon !"),children:"Download Data"})]})]}),e.jsxs(F,{children:[e.jsx(ae,{numSelected:U.length,filterName:g,onFilterName:Y}),e.jsx(te,{children:e.jsx(se,{sx:{overflow:"unset",p:2},children:e.jsxs(ne,{sx:{minWidth:800},children:[e.jsx(re,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Client Code"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Phone"}),e.jsx(i,{children:"View Credit"})]})}),e.jsxs(le,{children:[E.slice(h*c,h*c+c).map(a=>e.jsxs(p,{children:[e.jsx(i,{children:a==null?void 0:a.client_code}),e.jsx(i,{children:`${a==null?void 0:a.firstName} ${a==null?void 0:a.surname}`}),e.jsx(i,{children:a==null?void 0:a.phone}),e.jsx(i,{children:e.jsx(ie,{onClick:()=>z(a),children:e.jsx(oe,{})})})]},a._id)),G&&e.jsx(p,{children:e.jsx(i,{colSpan:8,align:"center",children:"No data found"})})]})]})})}),e.jsx(de,{rowsPerPageOptions:[5,10,25],component:"div",count:_,rowsPerPage:c,page:h,onPageChange:O,onRowsPerPageChange:V})]}),e.jsx(ce,{open:M,onClose:P,children:e.jsxs(B,{sx:{p:3,width:400,mx:"auto",mt:10,mb:10,bgcolor:"background.paper"},children:[e.jsx(I,{variant:"h6",gutterBottom:!0,children:"Add New Customer"}),e.jsxs("form",{onSubmit:Z,children:[e.jsx(o,{fullWidth:!0,label:"Date",name:"Date",value:new Date().toLocaleDateString()}),e.jsx(o,{label:"Client Id",name:"clientId",fullWidth:!0,margin:"normal",value:u}),e.jsx(o,{label:"First Name",name:"firstName",fullWidth:!0,margin:"normal",onChange:d,error:!!l.firstName,helperText:l.firstName}),e.jsx(o,{label:"Surname",name:"surname",fullWidth:!0,margin:"normal",onChange:d,error:!!l.surname,helperText:l.surname}),e.jsx(o,{label:"Phone",name:"phone",fullWidth:!0,margin:"normal",onChange:d,error:!!l.phone,helperText:l.phone}),e.jsx(o,{label:"Email",name:"email",fullWidth:!0,margin:"normal",onChange:d,error:!!l.email,helperText:l.email}),e.jsx(o,{label:"Address",name:"address",fullWidth:!0,margin:"normal",onChange:d,error:!!l.address,helperText:l.address}),e.jsxs(he,{name:"userType",value:n.userType,onChange:d,fullWidth:!0,margin:"normal",children:[e.jsx(L,{value:"RECEIVABLE",children:"RECEIVABLE"}),e.jsx(L,{value:"PAYABLE",children:"PAYABLE"})]}),e.jsx(B,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(f,{type:"submit",variant:"contained",color:"primary",children:"Add Customer"})})]})]})})]})}function je(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsx("title",{children:" User  "})}),e.jsx(me,{})]})}export{je as default};
